# PSVT: Pyramid Shifted Window based Vision Transformer for Cardiac Image Segmentation
## Abstract
Automating cardiac image analysis poses formidable challenges due to deformations during respiratory and cardiac cycles and the unique features of imaging modalities like CT and MRI. Transformer-based methods integrated with U-Net often miss essential local spatial details and incur high computational costs. To overcome these hurdles, we present the Pyramid Shifted-window-based Vision Transformer (PSVT), an innovative backbone for cardiac segmentation. Our model is meticulously designed to maintain a robust representation of both global and local features while operating on lower-dimensional inputs. By leveraging Continuous Position Bias in the Attention mechanism, we seamlessly integrate the attention module of Swin-Transformer-v2 with CNNs, yielding enhanced segmentation performance and computational efficiency. Additionally, we amplify receptive field understanding by incorporating Depth-Wise Convolution into the Feed-Forward module. Inspired by various adaptations of U-Net, we have restructured the Patch Merging and Patch Expanding modules, utilizing transposed convolution techniques to elegantly fuse multi-scale features into the classification head. Our experimental results compellingly demonstrate the superiority of PSVT, outperforming state-of-the-art cardiac segmentation models across three small-sample cardiac datasets: ACDC, MMWHS-CT, and LASC-2013. 

## Installation and Usage
1. Install MMSegmentation following the official guide: https://mmsegmentation.readthedocs.io/zh-cn/latest/get_started.html, here we use the latest version of MMSegmentation and pytorch 2.1.2 with cuda12.1.
2. Clone this repository and replace the configs and mmseg folder with the our folders.
3. Train or evaluate the model with configs/unet/fcn_psvt_256x256_25k_{dataset}.py following the official guide: https://mmsegmentation.readthedocs.io/zh-cn/latest/user_guides/4_train_test.html, where {dataset} can be acdc, mmwhs_ct, or lasc2013. If package is not installed, please install it with pip.